<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>お題シャッフル</title>

<!-- LZ-String（共有データの圧縮/伸長に使用） -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js" integrity="sha512-6rV8/cJqrr5fY5qUWbrB8Kfu2V0fDf+8C6u3tZL1j1+7zPA7m2Hq/2m/7rW9z8P1VhZf3zWdTnYw0FJr4jG5mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<style>
  body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; background: #f5f5f5; margin: 0; padding: 16px; color: #222; }
  .wrap { max-width: 480px; margin: 0 auto; }
  h1 { font-size: 1.2rem; font-weight: 600; margin: 0 0 12px; text-align: center; }
  .card { background: #fff; border-radius: 12px; border: 1px solid #ddd; padding: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 16px; }
  label { font-size: .9rem; font-weight: 600; display: block; margin-bottom: 6px; }
  select, input[type="text"], input[type="number"] { width: 100%; box-sizing: border-box; font-size: 1rem; padding: 8px 10px; margin-bottom: 8px; border-radius: 8px; border: 1px solid #ccc; }
  .row-flex { display: flex; gap: 8px; flex-wrap: wrap; }
  .btn { flex: 1; font-size: .95rem; font-weight: 600; padding: 10px 12px; border-radius: 8px; border: none; cursor: pointer; }
  .btn[disabled] { opacity: .6; cursor: not-allowed; }
  .btn-main { background: #2563eb; color: #fff; }
  .btn-gray { background: #eee; color: #222; }
  .btn-outline { background: #fff; color: #2563eb; border: 2px solid #2563eb; }
  .hint { font-size: .75rem; color: #666; margin-top: -4px; margin-bottom: 12px; }

  .result-box { background: #e8f0ff; border: 2px solid #2563eb; border-radius: 12px; padding: 20px 12px; text-align: center; min-height: 70px; display: flex; flex-direction: column; justify-content: center; }
  .result-main { font-size: 1.3rem; font-weight: 700; color: #2563eb; word-break: break-word; }
  .result-sub { font-size: .8rem; color: #555; margin-top: 8px; }

  .screen { display: none; }
  .screen.active { display: block; }

  .list-area { display: grid; grid-template-columns: 1fr; gap: 6px; margin-bottom: 8px; }
  .add-btn-row { text-align: right; margin-bottom: 8px; }
  .add-btn-row button { font-size: .8rem; padding: 6px 10px; border-radius: 6px; border: 1px solid #aaa; background: #fafafa; cursor: pointer; }

  /* モーダル（QR表示用） */
  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; padding:16px; box-sizing:border-box; z-index:9999; }
  .modal-overlay.active { display:flex; }
  .modal-card { background:#fff; width:100%; max-width:320px; border-radius:12px; border:1px solid #ddd; box-shadow:0 20px 40px rgba(0,0,0,0.3); padding:16px; text-align:center; }
  .modal-title { font-size:1rem; font-weight:600; margin-bottom:8px; }
  .qr-wrap { display:flex; flex-direction:column; align-items:center; justify-content:center; background:#fafafa; border:1px solid #ccc; border-radius:8px; padding:12px; margin-bottom:12px; }
  #qrCodeCanvas { margin-bottom:8px; }
  .share-url-box { font-size:.7rem; color:#444; word-break:break-all; background:#fff; border:1px solid #ccc; border-radius:6px; padding:8px; max-height:4.5em; overflow:auto; text-align:left; margin-bottom:12px; }
  .modal-btn-row { display:flex; gap:8px; flex-wrap:wrap; }
  .close-btn, .copy-btn { flex:1; border:none; border-radius:8px; padding:10px 12px; font-size:.9rem; font-weight:600; cursor:pointer; }
  .close-btn { background:#eee; }
  .copy-btn { background:#2563eb; color:#fff; }
  .copy-hint { font-size:.7rem; color:#2563eb; min-height:1em; margin-top:4px; text-align:center; }
</style>
</head>
<body>
<div class="wrap">

  <!-- 画面A：リスト作成 -->
  <section id="screen-setup" class="screen active">
    <h1>リスト作成</h1>

    <div class="card">
      <label for="presetSelect">プリセットを読み込む</label>
      <select id="presetSelect">
        <option value="">選択してください</option>
        <option value="omikuji">おみくじ</option>
        <option value="animal">どうぶつ当てクイズ</option>
        <option value="idol">アイドル当てクイズ</option>
        <option value="pref">都道府県当てクイズ</option>
      </select>
      <div class="hint">選ぶと下の入力欄が書き換わります。あとで編集できます。</div>
    </div>

    <div class="card">
      <label>お題リスト（1行1つ）</label>
      <div class="add-btn-row">
        <button id="addRowBtn">＋ 行を追加</button>
      </div>
      <div id="listContainer" class="list-area"></div>
      <div class="hint">初期状態では10行用意します。空欄は無視されます。</div>
    </div>

    <div class="card">
      <label for="drawCountInput">抽選回数</label>
      <input id="drawCountInput" type="number" min="1" value="10">
      <div class="hint">回数がリスト数より多い場合は、一巡ごとに自動シャッフルして繰り返します。</div>
    </div>

    <div class="card">
      <div class="row-flex">
        <button id="toDrawBtn" class="btn btn-main">シャッフル画面へ</button>
        <button id="shareBtn" class="btn btn-outline">このリストを共有</button>
      </div>
    </div>
  </section>

  <!--
